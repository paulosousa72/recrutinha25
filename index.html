<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>RA com A-Frame - Boneco 3D no Chão</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  </head>
  <body>
    <a-scene
      webxr="requiredFeatures: hit-test,dom-overlay;"
      renderer="logarithmicDepthBuffer: true;"
      vr-mode-ui="enabled">
      
      <!-- Boneco 3D -->
      <a-entity
        id="boneco"
        gltf-model="url(./boneco.glb)"
        scale="0.5 0.5 0.5"
        position="0 0 -2"
        class="cantap">
      </a-entity>

      <!-- Texto para controle de versão -->
      <a-text
        value="Versão 1.0 - Toque no chão para posicionar o boneco"
        color="white"
        position="0 0.5 -1"
        align="center"
        width="2"
        anchor="center"
        baseline="center">
      </a-text>

      <!-- Câmera -->
      <a-camera fov="60" position="0 1.6 0"></a-camera>
    </a-scene>

    <script>
      AFRAME.registerComponent('tap-place', {
        init: function () {
          const sceneEl = this.el.sceneEl;
          const boneco = document.getElementById('boneco');

          // Listener para toque na tela
          sceneEl.addEventListener('click', (event) => {
            if (sceneEl.is('ar-mode')) {
              const hitTestResults = sceneEl.renderer.xr.getHitTestResults(event.detail.cursor);
              if (hitTestResults.length > 0) {
                const pose = hitTestResults[0].getPose(sceneEl.renderer.xr.getReferenceSpace());
                const position = pose.transform.position;
                boneco.setAttribute('position', `${position.x} ${position.y} ${position.z - 2}`);
              }
            }
          });
        }
      });
    </script>
  </body>
</html>
